# File/Directory path traversal

## **what is:**

File or directory path traversal, also known as directory climbing or directory traversal attack, is a security vulnerability that allows an attacker to access files and directories that are stored outside the web root folder. By manipulating variables that reference files with `dot-dot-slash (../)` sequences and its variations, attackers can traverse to directories and access files that are not intended to be accessible.

## How It Works

1. **User Input:** The attacker finds a user input field that directly or indirectly references a file.
2. **Malicious Input:** The attacker inputs a path traversal string such as `../../../../../etc/passwd` to traverse directories.
3. **Execution:** The web application does not properly sanitize the input, allowing the traversal string to be processed.
4. **Access:** The attacker gains access to files or directories outside the intended directory.

## dot dot slash (../) 
`../` -> its mead the Directory move one level back towards the root directory .
 **for example :**
 the `C:\Windows\Log\Config\..\..\` equl to  `C:\Windows` 
* On Windows operating sytem 
`..\..\..\windows\win.ini` 
* On Windows, both `../` and `..\` are valid directory traversal sequences
* On Unix-based operating systems
`../../../etc/passwd`



## Linux filesystem and directory structure
```
ğŸ“ /
â”œâ”€â”€ ğŸ“ bin
â”‚   â”œâ”€â”€ âš™ï¸ ls
â”‚   â””â”€â”€ âš™ï¸ bash
â”œâ”€â”€ ğŸ“ boot
â”‚   â”œâ”€â”€ ğŸ’¾ vmlinuz
â”‚   â””â”€â”€ ğŸ’¾ initrd.img
â”œâ”€â”€ ğŸ“ dev
â”‚   â”œâ”€â”€ ğŸ’¿ sda1
â”‚   â””â”€â”€ ğŸ’¿ sdb
â”œâ”€â”€ ğŸ“ etc
â”‚   â”œâ”€â”€ ğŸ› ï¸ passwd
â”‚   â””â”€â”€ ğŸ› ï¸ fstab
â”œâ”€â”€ ğŸ“ home
â”‚   â”œâ”€â”€ ğŸ“ james
â”‚   â”‚   â”œâ”€â”€ ğŸ› ï¸ .bashrc
â”‚   â”‚   â”œâ”€â”€ ğŸ“ documents
â”‚   â”‚   â””â”€â”€ ğŸ“ .ssh
â”‚   â”‚       â”œâ”€â”€ ğŸ” id_rsa
â”‚   â”‚       â””â”€â”€ ğŸ”‘ authorized_keys
â”‚   â””â”€â”€ ğŸ“ traw
â”‚       â”œâ”€â”€ ğŸ› ï¸ .profile
â”‚       â”œâ”€â”€ ğŸ“ pictures
â”‚       â””â”€â”€ ğŸ“ .ssh
â”‚           â”œâ”€â”€ ğŸ” id_rsa
â”‚           â””â”€â”€ ğŸ”‘ authorized_keys
â”œâ”€â”€ ğŸ“ lib
â”‚   â”œâ”€â”€ âš™ï¸ http://libc.so
â”‚   â””â”€â”€ âš™ï¸ http://libm.so
â”œâ”€â”€ ğŸ“ media
â”‚   â”œâ”€â”€ ğŸ“ cdrom
â”‚   â””â”€â”€ ğŸ“ usb
â”œâ”€â”€ ğŸ“ mnt
â”‚   â””â”€â”€ ğŸ“ mymount
â”œâ”€â”€ ğŸ“ opt
â”‚   â””â”€â”€ ğŸ“ myapp
â”œâ”€â”€ ğŸ“ proc
â”‚   â”œâ”€â”€ ğŸ“„ cpuinfo
â”‚   â””â”€â”€ ğŸ“„ meminfo
â”œâ”€â”€ ğŸ“ root
â”‚   â”œâ”€â”€ ğŸ› ï¸ .bash_history
â”‚   â””â”€â”€ ğŸ“ .ssh
â”‚       â”œâ”€â”€ ğŸ” id_rsa
â”‚       â””â”€â”€ ğŸ”‘ authorized_keys
â”œâ”€â”€ ğŸ“ run
â”‚   â”œâ”€â”€ ğŸ“„ utmp
â”‚   â””â”€â”€ ğŸ“„ systemd
â”œâ”€â”€ ğŸ“ sbin
â”‚   â”œâ”€â”€ âš™ï¸ init
â”‚   â””â”€â”€ âš™ï¸ reboot
â”œâ”€â”€ ğŸ“ srv
â”‚   â””â”€â”€ ğŸ“ myservice
â”œâ”€â”€ ğŸ“ sys
â”‚   â”œâ”€â”€ ğŸ“„ devices
â”‚   â””â”€â”€ ğŸ“„ firmware
â”œâ”€â”€ ğŸ“ tmp
â”‚   â”œâ”€â”€ ğŸ“„ temp1
â”‚   â””â”€â”€ ğŸ“„ temp2
â”œâ”€â”€ ğŸ“ usr
â”‚   â”œâ”€â”€ ğŸ“ bin
â”‚   â”‚   â”œâ”€â”€ âš™ï¸ perl
â”‚   â”‚   â””â”€â”€ âš™ï¸ python
â”‚   â”œâ”€â”€ ğŸ“ lib
â”‚   â”‚   â”œâ”€â”€ âš™ï¸ http://libssl.so
â”‚   â”‚   â””â”€â”€ âš™ï¸ http://libcrypto.so
â”‚   â””â”€â”€ ğŸ“ local
â”‚       â”œâ”€â”€ ğŸ“ bin
â”‚       â”œâ”€â”€ ğŸ“ lib
â”‚       â””â”€â”€ ğŸ“ share
â””â”€â”€ ğŸ“ var
    â”œâ”€â”€ ğŸ“ log
    â”‚   â”œâ”€â”€ ğŸ“„ syslog
    â””â”€â”€ ğŸ“„ auth.log
    â”œâ”€â”€ ğŸ“ mail
    â”œâ”€â”€ ğŸ“ run
    â”œâ”€â”€ ğŸ“ spool
    â””â”€â”€ ğŸ“ www
```
## Example

- Imagine a web application that serves files based on user input, like so:

```bash
http://example.com/showfile?filename=report.txt
```

- If the application is vulnerable to path traversal, an attacker could modify the URL to:

```bash
http://example.com/showfile?filename=../../../../etc/passwd
```

This could grant access to the `/etc/passwd` file on a Unix-based system, which contains user account information.

## Mitigation

1. **Input Validation:** Ensure that user input is validated and sanitized to allow only expected values.
2. **Use of Secure APIs**: Use file APIs that do not allow navigation to parent directories using relative paths.
3. **Access Controls:** Implement proper access controls to restrict user access to only necessary files and directories.
4. **Configuration:** Configure the web server to disallow the execution of scripts or the reading of files from outside the web root directory.
5. **File System Permissions:** Ensure that the web application has the minimum necessary permissions to read or write files.
